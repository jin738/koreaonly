

@{
    var Reqst = (KoreaOnly.Models.SoapWorkflowPostRQ)Session["REQUEST"];
    var SearchFillter = (KoreaOnly.Models.SearchFillter)Session["SearchFillter"];
}

<script>
    $(function () {
        $("#slider-range").slider({
            range: true,
            min: @SearchFillter.PriceFillter[0],
            max: @SearchFillter.PriceFillter[1],
            values: [@SearchFillter.PriceFillter[2], @SearchFillter.PriceFillter[3]],
            slide: function (event, ui) {
                $("#stamount").val("$" + ui.values[0]);
                $("#edamount").val("$" + ui.values[1]);
                dosearch("price slider");
            }
        });

        $("#stamount").val("$" + $("#slider-range").slider("values", 0));
        $("#edamount").val("$" + $("#slider-range").slider("values", 1));

        $("#slider-range2").slider({
            range: true,
            min: 0,
            max: 1440,
            step: 15,
            values: [0, 1440],
            slide: function (event, ui) {

                var hours1 = Math.floor(ui.values[0] / 60);
                var minutes1 = ui.values[0] - (hours1 * 60);

                if (hours1.length == 1) hours1 = '0' + hours1;
                if (minutes1.length == 1) minutes1 = '0' + minutes1;
                if (minutes1 == 0) minutes1 = '00';
                if (hours1 >= 12) {
                    if (hours1 == 12) {
                        hours1 = hours1;
                        minutes1 = minutes1 + " PM";
                    } else {
                        hours1 = hours1 - 12;
                        minutes1 = minutes1 + " PM";
                    }
                } else {
                    hours1 = hours1;
                    minutes1 = minutes1 + " AM";
                }
                if (hours1 == 0) {
                    hours1 = 12;
                    minutes1 = minutes1;
                }


                $('#stamount2val').val(ui.values[0]);
                $('#stamount2').val(hours1 + ':' + minutes1);

                var hours2 = Math.floor(ui.values[1] / 60);
                var minutes2 = ui.values[1] - (hours2 * 60);

                if (hours2.length == 1) hours2 = '0' + hours2;
                if (minutes2.length == 1) minutes2 = '0' + minutes2;
                if (minutes2 == 0) minutes2 = '00';
                if (hours2 >= 12) {
                    if (hours2 == 12) {
                        hours2 = hours2;
                        minutes2 = minutes2 + " PM";
                    } else if (hours2 == 24) {
                        hours2 = 11;
                        minutes2 = "59 PM";
                    } else {
                        hours2 = hours2 - 12;
                        minutes2 = minutes2 + " PM";
                    }
                } else {
                    hours2 = hours2;
                    minutes2 = minutes2 + " AM";
                }

                $('#edamount2val').val(ui.values[1]);
                $('#edamount2').val(hours2 + ':' + minutes2);
                dosearch("time slider");
            }
        });

        $("#stamount2").val("12:00 AM");
        $("#edamount2").val("11:59 PM");

    });

    function dosearch(whoclick){
        // console.log(whoclick);
        $("#btnsearchsubmit").click();

    }

    function AddSearchoption(inputid){
        var Apt = $("#"+inputid).val();

        var options = {
            url: function (phrase) {
                return "/Index/GetAllAirports?AirCode=" + ($("#"+inputid).val());
            },
            list: {
                match: {
                    enabled: true
                }
            },
            theme: "plate-dark",
            getValue: "name"
        };


        $("#"+inputid).easyAutocomplete(options);
    }

</script>

<div class="row" style="margin-top:18px;">
    <div id="mobilefilter" class="filtert">
        <div class="contentsdw">
            <div class="filtersho">
                <span class="nrow">Refine Your Search </span>
            </div>
            <div class="inmodify">

                <form method="POST" style="padding:10px;" id="frm1" action="/Index/SearchFlight">

                    <h4 style="font-weight: bold;" class="h4heading">Stop</h4>
                    <div style="padding: 10px;">
                        <label class="container2 subval" id="divstop1">
                            non-stop
                            <input type="checkbox" @( SearchFillter.Stop1 == "on" ? "checked='checked'" : "" ) name="stop1">
                            <span class="checkmark2"></span>
                            <span class="onlythis stopclickE" id="onlystop1">only</span>
                        </label>
                        <label class="container2 subval" id="divstop2">
                            1 Stop
                            <input type="checkbox" @( SearchFillter.Stop2 == "on" ? "checked='checked'" : "" ) name="stop2">
                            <span class="checkmark2"></span>
                            <span class="onlythis stopclickE" id="onlystop2">only</span>
                        </label>
                        <label class="container2 subval" id="divstop3">
                            2+ Stop
                            <input type="checkbox" @( SearchFillter.Stop3 == "on" ? "checked='checked'" : "" ) name="stop3">
                            <span class="checkmark2"></span>
                            <span class="onlythis stopclickE" id="onlystop3">only</span>
                        </label>
                    </div>

                    <script>
                        $(document).ready(function () {
                            setEventOnlyDiv("divstop1", "onlystop1");
                            setEventOnlyDiv("divstop2", "onlystop2");
                            setEventOnlyDiv("divstop3", "onlystop3");
                        });
                    </script>

                    <br />
                    <h4 style="font-weight: bold;" class="h4heading">Airlines</h4>
                    <div style="padding: 10px;">

                        @foreach (var airline in SearchFillter.Airlines)
                        {
                            var airlname = MainController.GetAirline(airline[0]).AirlineName.Replace(" ", "");

                            @*<label class="container2 subval" id="flight@(airline[0])" onclick="checkit('@(airlname)', 'div@(airlname)','@(airline[0])')">

                                    @MainController.GetAirline(airline[0]).AirlineName

                                    @* CHECK BOX
                                    <input datae="@(airlname)=div@(airlname)=@(airline[0])" type="checkbox" @( airline[1] == "1" ? "checked='checked'" : "" ) name="AirlineChk" id="@airlname">


                                    @* CHECK BOX HIDDEN Feild
                                    <input type="text" value="@(airline[0])@(airline[1])" name="Airline" id="div@(airlname)">

                                    <span class="checkmark2" onclick="checkit('@(airlname)', 'div@(airlname)','@(airline[0])')"></span>
                                    <span class="onlythis onlythisF" style="background-color:#166fc1;color:white;font-size: 1em;" id="onlyflight@(airline[0])">only</span>

                                    <script>
                                        setEventOnlyDiv("flight@(airline[0])", "onlyflight@(airline[0])");
                                    </script>

                                </label>*@

                            <label class="container2 subval" id="flight@(airline[0])">

                                @MainController.GetAirline(airline[0]).AirlineName

                                @* CHECK BOX *@
                                <input datae="@(airlname)=div@(airlname)=@(airline[0])" type="checkbox" @( airline[1] == "1" ? "checked='checked'" : "" ) name="AirlineChk" id="@airlname">


                                @* CHECK BOX HIDDEN Feild *@
                                <input type="text" value="@(airline[0])@(airline[1])" name="Airline" id="div@(airlname)">

                                <span class="checkmark2"></span>
                                <span class="onlythis onlythisF" style="background-color:#166fc1;color:white;font-size: 1em;" id="onlyflight@(airline[0])">only</span>

                                <script>
                                    $(document).ready(function(){
                                        setEventOnlyDiv("flight@(airline[0])", "onlyflight@(airline[0])");
                                    });
                                </script>

                            </label>

                        }

                    </div>

                    <br />
                    <h4 style="font-weight: bold;" class="h4heading">Filter By Price</h4>
                    <div style="padding: 10px;">
                        <p>
                            <input type="text" id="stamount" name="pricefrom" class="fliteramount subval" readonly style="border:0; color:#128fff;font-weight:bold;float:left;text-align: left;">
                            <input type="text" id="edamount" name="priceto" class="fliteramount subval" readonly style="border:0; color:#128fff;font-weight:bold;float:right;text-align: right;">
                        </p>

                        <div id="slider-range" style="margin-top:25px;"></div>
                    </div>

                    <br />

                    <h4 style="font-weight: bold;" class="h4heading">Filter By Departure Time</h4>
                    <div style="padding: 10px;">
                        <p>
                            <input type="text" id="stamount2val" name="stamount2val" class="fliteramount subval" readonly style="display:none; border:0; color:#128fff;font-weight:bold;float:left;text-align: left;">
                            <input type="text" id="edamount2val" name="edamount2val" class="fliteramount subval" readonly style="display:none; border:0; color:#128fff;font-weight:bold;float:right;text-align: right;">

                            <input type="text" id="stamount2" name="stamount2" class="fliteramount subval" readonly style="border:0; color:#128fff;font-weight:bold;float:left;text-align: left;">
                            <input type="text" id="edamount2" name="edamount2" class="fliteramount subval" readonly style="border:0; color:#128fff;font-weight:bold;float:right;text-align: right;">
                        </p>

                        <div id="slider-range2" style="margin-top:25px;"></div>
                    </div>
                    <div>
                        <input type="button" class="btn btn-primary btnTheam btnx" id="btnsearchsubmit" value="Search" style="width:100%;">
                    </div>

                    <script>

                        $("#btnsearchsubmit").click(function () {

                            $("loadingdiv").show();

                            $("#loadingdivsFlight").show();
                            $.ajax({
                                type: "POST",
                                data:$("#frm1").serialize(),
                                url: "/Index/SearchFlight",
                                success: function (response) {
                                    $("#AllFlights").html(response);
                                    $("#loadingdivsFlight").hide();

                                    //$.ajax({
                                    //    type: "POST",
                                    //    url: "/Index/GetCheapestFlights",
                                    //    success: function (response) {
                                    //        $("#CheapestFlightsSection").html(response);
                                    //        $("#loadingdivsFlight").hide();
                                    //    }
                                    //});

                                    //$.ajax({
                                    //    type: "POST",
                                    //    url: "/Index/GetSearchFlightsPanel",
                                    //    success: function (response) {
                                    //        $("#SearchFlightsPanel").html(response);
                                    //        $("#loadingdivsFlight").hide();
                                    //    }
                                    //});



                                }
                            });
                        });
                    </script>

                </form>

            </div>
        </div>
    </div>
</div>


<script src="~/scripts/Koreaonly.js"></script>

